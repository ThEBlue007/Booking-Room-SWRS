<!doctype html><html lang="th"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Booking Room SWRS</title><script src="https://cdn.tailwindcss.com"></script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"><style>body{font-family:Inter,sans-serif;background-color:#f3f4f6}.container{max-width:960px}.message-box{position:fixed;top:20px;right:20px;background-color:#4caf50;color:#fff;padding:15px 20px;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,.1);z-index:1000;opacity:0;transition:opacity .5s ease-in-out;pointer-events:none}.message-box.show{opacity:1;pointer-events:auto}.h-layout-container{position:relative;width:100%;padding-top:66.67%;background-image:url('https://placehold.co/900x600/ffffff/ffffff');background-size:contain;background-repeat:no-repeat;background-position:center}.room{position:absolute;width:8%;height:11%;border-radius:4px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.75rem;color:#fff;transition:transform .2s,box-shadow .2s}.room:hover{transform:scale(1.1);box-shadow:0 4px 10px rgba(0,0,0,.2)}.room.available{background-color:#34d399;cursor:pointer}.room.special{background-color:#60a5fa;cursor:pointer}.room.booked{background-color:#f87171}.room.logo-thai-flag::before{content:'üö©';position:absolute;top:0;left:-250%;font-size:1.5rem;transform:scaleX(-1)}.room.logo-pig::before{content:'üê∑';position:absolute;top:0;left:250%;font-size:1.5rem}.tab-button{padding:10px 20px;cursor:pointer;border-radius:8px 8px 0 0;font-weight:600;transition:background-color .2s}.tab-button.active{background-color:#fff;color:#4338ca}.tab-button:not(.active){background-color:#e5e7eb;color:#6b7280}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content{background-color:#fff;padding:24px;border-radius:8px;box-shadow:0 10px 25px rgba(0,0,0,.2);max-width:400px;width:90%;position:relative}.close-button{position:absolute;top:8px;right:12px;font-size:1.5rem;cursor:pointer}.calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:5px}.calendar-day,.calendar-day-header{text-align:center;padding:8px;border-radius:4px}.calendar-day-header{font-weight:600;color:#4b5563}.calendar-day{background-color:#e5e7eb;cursor:pointer;transition:background-color .2s}.calendar-day:hover{background-color:#d1d5db}.calendar-day.current-day{background-color:#4338ca;color:#fff}.calendar-day.selected-day{background-color:#6366f1;color:#fff;border:2px solid #4338ca}</style><script defer="defer" src="/static/js/main.62a4503b.js"></script><link href="/static/css/main.f855e6bc.css" rel="stylesheet"></head><body class="bg-gray-100 flex items-center justify-center min-h-screen"><div id="login-container" class="bg-white p-8 rounded-lg shadow-xl w-full max-w-sm"><h2 class="text-2xl font-bold text-center text-gray-800 mb-6">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2><form id="login-form" class="space-y-4"><div><label for="student-id" class="block text-sm font-medium text-gray-700">‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ï‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label> <input id="student-id" name="student-id" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" required></div><div><label for="birthday" class="block text-sm font-medium text-gray-700">‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î:</label> <input type="date" id="birthday" name="birthday" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" required></div><div><button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button></div></form></div><div id="main-app-container" class="container mx-auto p-6 bg-white rounded-lg shadow-xl hidden"><h1 class="text-3xl md:text-4xl font-bold text-center text-gray-800 mb-6">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1><p class="text-center text-gray-600 mb-8">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤‡∏£‡∏™‡∏≤‡∏™‡∏ô‡πå‡∏ß‡∏¥‡πÄ‡∏ó‡∏®‡∏£‡∏±‡∏á‡∏™‡∏¥‡∏ï ‡∏ï‡∏∂‡∏Å 3</p><div class="text-center text-sm text-gray-500 mb-4">‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ï‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <span id="student-id-display"></span></div><div class="flex justify-center mb-4 border-b border-gray-200"><button id="main-tab" class="tab-button active">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button> <button id="history-tab" class="tab-button">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</button> <button id="calendar-tab" class="tab-button">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</button></div><div id="main-content"><div class="mb-6 flex justify-center"><label for="floor-select" class="block text-sm font-medium text-gray-700 mr-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô:</label> <select id="floor-select" name="floor" class="mt-1 block px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"></select></div><div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-x-16"><div class="bg-gray-50 p-6 rounded-lg shadow-inner"><h2 class="text-2xl font-semibold text-gray-800 mb-4 text-center">‡∏ú‡∏±‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏ä‡∏±‡πâ‡∏ô <span id="current-floor">1</span>)</h2><div id="classroom-layout" class="h-layout-container w-full mx-auto"></div></div><div id="booking-form-container" class="bg-gray-50 p-6 rounded-lg shadow-inner hidden"><h2 id="form-title" class="text-2xl font-semibold text-gray-700 mb-4">‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h2><form id="booking-form" class="space-y-4"><div><label for="teacher" class="block text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô:</label> <input id="teacher" name="teacher" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" required></div><div><label for="subject" class="block text-sm font-medium text-gray-700">‡∏ß‡∏¥‡∏ä‡∏≤:</label> <input id="subject" name="subject" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" required></div><div><label for="date" class="block text-sm font-medium text-gray-700">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label> <input type="date" id="date" name="date" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" required></div><div><label for="time" class="block text-sm font-medium text-gray-700">‡πÄ‡∏ß‡∏•‡∏≤:</label> <select id="time" name="time" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" required><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</option><option value="08:10">08:10 - 09:00</option><option value="09:00">09:00 - 9:50</option><option value="09:50">09:50 - 10:40</option><option value="10:55">10:55 - 11:45</option><option value="11:45">11:45 - 12:35</option><option value="13:35">13:35 - 14:25</option><option value="14:25">14:25 - 15:15</option><option value="15:30">15:30 - 16:20</option></select></div><div><label for="purpose" class="block text-sm font-medium text-gray-700">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:</label> <textarea id="purpose" name="purpose" rows="3" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" required></textarea></div><div><button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</button></div></form></div></div></div><div id="booking-history-container" class="hidden"><h2 class="text-2xl font-semibold text-gray-800 mb-4">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h2><div id="booking-list" class="space-y-4"><p class="text-gray-500 text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</p></div></div><div id="calendar-container" class="hidden"><div class="bg-gray-50 p-6 rounded-lg shadow-inner"><div class="flex justify-between items-center mb-4"><button id="prev-month-btn" class="text-indigo-600 hover:text-indigo-800 font-bold">&lt; ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button><h3 id="current-month-year" class="text-xl font-semibold text-gray-800"></h3><button id="next-month-btn" class="text-indigo-600 hover:text-indigo-800 font-bold">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ &gt;</button></div><div id="calendar-grid" class="calendar-grid"><div class="calendar-day-header">‡∏≠‡∏≤</div><div class="calendar-day-header">‡∏à</div><div class="calendar-day-header">‡∏≠</div><div class="calendar-day-header">‡∏û</div><div class="calendar-day-header">‡∏û‡∏§</div><div class="calendar-day-header">‡∏®</div><div class="calendar-day-header">‡∏™</div></div><div class="mt-6"><h4 class="text-lg font-semibold text-gray-700 mb-2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <span id="selected-date-display"></span></h4><div class="mb-4"><label for="room-filter" class="block text-sm font-medium text-gray-700 mb-1">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡πâ‡∏≠‡∏á:</label> <select id="room-filter" class="w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"></select></div><div id="daily-bookings-list" class="space-y-2"><p class="text-gray-500">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</p></div></div></div></div></div><div id="message-box" class="message-box"><p id="message-text"></p></div><div id="confirm-cancel-modal" class="modal-overlay hidden"><div class="modal-content"><h3 class="text-xl font-bold mb-4">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</h3><p id="confirm-cancel-message" class="mb-4">‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</p><div class="flex justify-end space-x-4"><button id="cancel-confirm-btn" class="px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600">‡πÉ‡∏ä‡πà, ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button> <button id="cancel-no-btn" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400">‡πÑ‡∏°‡πà</button></div></div></div><div id="booking-details-modal" class="modal-overlay hidden"><div class="modal-content"><span class="close-button" id="close-modal">&times;</span><h3 class="text-xl font-bold mb-4">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h3><p><span class="font-semibold">‡∏´‡πâ‡∏≠‡∏á:</span> <span id="modal-room-name"></span></p><p><span class="font-semibold">‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô:</span> <span id="modal-teacher"></span></p><p><span class="font-semibold">‡∏ß‡∏¥‡∏ä‡∏≤:</span> <span id="modal-subject"></span></p><p><span class="font-semibold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</span> <span id="modal-date"></span></p><p><span class="font-semibold">‡πÄ‡∏ß‡∏•‡∏≤:</span> <span id="modal-time"></span></p><p><span class="font-semibold">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:</span> <span id="modal-purpose"></span></p><p><span class="font-semibold">‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ï‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</span> <span id="modal-student-id"></span></p></div></div><script type="module">import{initializeApp}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";import{getAuth,signInWithCustomToken,signInAnonymously}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";import{getFirestore,doc,getDoc,addDoc,setDoc,updateDoc,deleteDoc,onSnapshot,collection,query,where}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";const appId="undefined"!=typeof __app_id?__app_id:"default-app-id",firebaseConfig="undefined"!=typeof __firebase_config?JSON.parse(__firebase_config):{},initialAuthToken="undefined"!=typeof __initial_auth_token?__initial_auth_token:null;let db,loggedInStudentId=null;const floors=7,roomsPerFloor=22,classrooms=[];let liveBookings=[],currentCalendarDate=new Date;const roomCoordinates={1:{top:"0%",left:"5%"},2:{top:"0%",left:"15%"},3:{top:"20%",left:"15%"},4:{top:"35%",left:"15%"},5:{top:"50%",left:"15%"},6:{top:"65%",left:"15%"},7:{top:"80%",left:"15%"},8:{top:"100%",left:"5%"},9:{top:"100%",left:"15%"},10:{top:"50%",left:"30%"},11:{top:"50%",left:"40%"},12:{top:"50%",left:"50%"},13:{top:"50%",left:"60%"},14:{top:"0%",left:"75%"},15:{top:"0%",left:"85%"},16:{top:"20%",left:"75%"},17:{top:"35%",left:"75%"},18:{top:"50%",left:"75%"},19:{top:"65%",left:"75%"},20:{top:"80%",left:"75%"},21:{top:"100%",left:"75%"},22:{top:"100%",left:"85%"}};for(let e=1;e<=7;e++)for(let t=1;t<=22;t++){let n,o=null;n=e>=2&&e<=4&&t>=10&&t<=13?"special":"available",5===t&&(o="thai-flag"),18===t&&(o="pig"),classrooms.push({id:`F${e}-R${t}`,name:`‡∏´‡πâ‡∏≠‡∏á ${e}${String(t).padStart(2,"0")}`,type:n,coords:roomCoordinates[t],logo:o})}const loginContainer=document.getElementById("login-container"),mainAppContainer=document.getElementById("main-app-container"),loginForm=document.getElementById("login-form"),studentIdDisplay=document.getElementById("student-id-display"),mainTab=document.getElementById("main-tab"),historyTab=document.getElementById("history-tab"),calendarTab=document.getElementById("calendar-tab"),mainContent=document.getElementById("main-content"),historyContent=document.getElementById("booking-history-container"),calendarContent=document.getElementById("calendar-container"),floorSelect=document.getElementById("floor-select"),currentFloorDisplay=document.getElementById("current-floor"),classroomLayout=document.getElementById("classroom-layout"),bookingFormContainer=document.getElementById("booking-form-container"),bookingForm=document.getElementById("booking-form"),formTitle=document.getElementById("form-title"),messageBox=document.getElementById("message-box"),messageText=document.getElementById("message-text"),bookingList=document.getElementById("booking-list"),bookingDetailsModal=document.getElementById("booking-details-modal"),closeModalBtn=document.getElementById("close-modal"),confirmCancelModal=document.getElementById("confirm-cancel-modal"),cancelConfirmBtn=document.getElementById("cancel-confirm-btn"),cancelNoBtn=document.getElementById("cancel-no-btn"),currentMonthYearDisplay=document.getElementById("current-month-year"),prevMonthBtn=document.getElementById("prev-month-btn"),nextMonthBtn=document.getElementById("next-month-btn"),calendarGrid=document.getElementById("calendar-grid"),dailyBookingsList=document.getElementById("daily-bookings-list"),selectedDateDisplay=document.getElementById("selected-date-display"),roomFilterSelect=document.getElementById("room-filter");let selectedClassroomId=null,bookingToDeleteId=null,selectedCalendarDate=new Date;function formatDate(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function showMessage(e,t=!1){messageText.textContent=e,messageBox.style.backgroundColor=t?"#f44336":"#4CAF50",messageBox.classList.add("show"),setTimeout(()=>{messageBox.classList.remove("show")},3e3)}function renderClassrooms(){const e=floorSelect.value,t=document.getElementById("date").value,n=document.getElementById("time").value;currentFloorDisplay.textContent=e;const o=classrooms.filter(t=>t.id.startsWith(`F${e}-`));let a;a=1===parseInt(e)?o.filter(e=>{const t=parseInt(e.id.split("-R")[1]);return t<10||t>13}):o,classroomLayout.innerHTML="",a.forEach(e=>{const o=document.createElement("div"),a=liveBookings.find(o=>o.classroomId===e.id&&o.date===t&&o.time===n);let s=`room ${e.type}`;a?(s="room booked",o.style.cursor="not-allowed",o.addEventListener("click",()=>{showMessage("‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ. ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≠‡∏á",!0)})):(s="room available",o.style.cursor="pointer",o.addEventListener("click",()=>{selectedClassroomId=e.id,formTitle.textContent=`‡∏à‡∏≠‡∏á ${e.name}`,bookingFormContainer.classList.remove("hidden"),bookingFormContainer.scrollIntoView({behavior:"smooth"})})),e.logo&&(s+=` logo-${e.logo}`),o.className=s,o.textContent=e.name,o.style.top=e.coords.top,o.style.left=e.coords.left,classroomLayout.appendChild(o)})}function renderBookingHistory(){const e=liveBookings.filter(e=>e.studentId===loggedInStudentId);if(0===e.length)return void(bookingList.innerHTML='<p class="text-gray-500 text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>');bookingList.innerHTML="",e.forEach(e=>{const t=document.createElement("div");t.className="p-4 bg-gray-100 rounded-lg shadow-sm flex justify-between items-center",t.innerHTML=`\n                    <div>\n                        <p><span class="font-semibold">‡∏´‡πâ‡∏≠‡∏á:</span> ${e.classroomName}</p>\n                        <p><span class="font-semibold">‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô:</span> ${e.teacher}</p>\n                        <p><span class="font-semibold">‡∏ß‡∏¥‡∏ä‡∏≤:</span> ${e.subject}</p>\n                        <p><span class="font-semibold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</span> ${e.date}</p>\n                        <p><span class="font-semibold">‡πÄ‡∏ß‡∏•‡∏≤:</span> ${e.time}</p>\n                        <p><span class="font-semibold">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:</span> ${e.purpose}</p>\n                        <p><span class="font-semibold">‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ï‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</span> ${e.studentId}</p>\n                    </div>\n                    <button class="cancel-booking-btn bg-red-500 text-white px-3 py-1 rounded-md hover:bg-red-600 transition-colors" data-id="${e.id}">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>\n                `,bookingList.appendChild(t)});document.querySelectorAll(".cancel-booking-btn").forEach(e=>{e.addEventListener("click",e=>{bookingToDeleteId=e.target.dataset.id,confirmCancelModal.classList.remove("hidden")})})}function renderCalendar(){calendarGrid.innerHTML="";const e=new Date,t=new Date(currentCalendarDate.getFullYear(),currentCalendarDate.getMonth(),1),n=new Date(currentCalendarDate.getFullYear(),currentCalendarDate.getMonth()+1,0),o=t.getDay();currentMonthYearDisplay.textContent=`${["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå","‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°","‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô","‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°","‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô","‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°","‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô","‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°","‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô","‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"][currentCalendarDate.getMonth()]} ${currentCalendarDate.getFullYear()}`;for(let e=0;e<o;e++){const e=document.createElement("div");e.className="calendar-day",e.style.visibility="hidden",calendarGrid.appendChild(e)}for(let t=1;t<=n.getDate();t++){const n=document.createElement("div"),o=new Date(currentCalendarDate.getFullYear(),currentCalendarDate.getMonth(),t),a=formatDate(o);n.textContent=t,n.className="calendar-day",n.dataset.date=a,a===formatDate(e)&&n.classList.add("current-day"),a===formatDate(selectedCalendarDate)&&n.classList.add("selected-day"),n.addEventListener("click",()=>{selectedCalendarDate=o,document.querySelectorAll(".calendar-day").forEach(e=>e.classList.remove("selected-day")),n.classList.add("selected-day"),displayBookingsForDate(o)}),calendarGrid.appendChild(n)}populateRoomFilter(),displayBookingsForDate(selectedCalendarDate)}function populateRoomFilter(){roomFilterSelect.innerHTML='<option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>',classrooms.forEach(e=>{const t=document.createElement("option");t.value=e.id,t.textContent=e.name,roomFilterSelect.appendChild(t)}),roomFilterSelect.addEventListener("change",()=>{displayBookingsForDate(selectedCalendarDate)})}function displayBookingsForDate(e){const t=formatDate(e);selectedDateDisplay.textContent=t,dailyBookingsList.innerHTML="";let n=liveBookings.filter(e=>e.date===t);const o=roomFilterSelect.value;o&&(n=n.filter(e=>e.classroomId===o)),0!==n.length?(n.sort((e,t)=>e.time.localeCompare(t.time)),n.forEach(e=>{const t=document.createElement("div");t.className="p-3 bg-white rounded-md shadow-sm",t.innerHTML=`\n                    <p><span class="font-semibold">‡∏´‡πâ‡∏≠‡∏á:</span> ${e.classroomName}</p>\n                    <p><span class="font-semibold">‡πÄ‡∏ß‡∏•‡∏≤:</span> ${e.time}</p>\n                    <p><span class="font-semibold">‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á:</span> ${e.studentId}</p>\n                `,dailyBookingsList.appendChild(t)})):dailyBookingsList.innerHTML='<p class="text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>'}async function handleCancelBooking(){if(bookingToDeleteId)try{const e=doc(db,`artifacts/${appId}/public/data/bookings`,bookingToDeleteId);await deleteDoc(e),showMessage("‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß")}catch(e){console.error("Error deleting document: ",e),showMessage("‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á",!0)}finally{confirmCancelModal.classList.add("hidden"),bookingToDeleteId=null}}function initializeAppUI(){for(let e=1;e<=7;e++){const t=document.createElement("option");t.value=e,t.textContent=`‡∏ä‡∏±‡πâ‡∏ô ${e}`,floorSelect.appendChild(t)}floorSelect.value=1;const e=document.getElementById("date"),t=document.getElementById("time");e.addEventListener("change",renderClassrooms),t.addEventListener("change",renderClassrooms),floorSelect.addEventListener("change",renderClassrooms)}function setupFirestoreListener(){if(!db)return void console.error("Firestore is not initialized.");const e=collection(db,`artifacts/${appId}/public/data/bookings`);onSnapshot(e,e=>{liveBookings=[],e.forEach(e=>{liveBookings.push({id:e.id,...e.data()})}),console.log("Real-time booking data updated:",liveBookings),renderClassrooms(),renderBookingHistory(),renderCalendar()},e=>{console.error("Error getting real-time updates:",e),showMessage("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ",!0)})}bookingForm.addEventListener("submit",async e=>{if(e.preventDefault(),!loggedInStudentId)return void showMessage("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô",!0);const t=document.getElementById("teacher").value,n=document.getElementById("subject").value,o=document.getElementById("date").value,a=document.getElementById("time").value,s=document.getElementById("purpose").value;if(liveBookings.some(e=>e.classroomId===selectedClassroomId&&e.date===o&&e.time===a))return void showMessage("‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏∑‡πà‡∏ô",!0);const l=classrooms.find(e=>e.id===selectedClassroomId),d={classroomId:selectedClassroomId,classroomName:l.name,teacher:t,subject:n,date:o,time:a,purpose:s,studentId:loggedInStudentId};try{const e=collection(db,`artifacts/${appId}/public/data/bookings`);await addDoc(e,d),showMessage("‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!"),bookingForm.reset(),bookingFormContainer.classList.add("hidden"),selectedClassroomId=null,renderClassrooms()}catch(e){console.error("Error adding document: ",e),showMessage("‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á",!0)}}),mainTab.addEventListener("click",()=>{document.querySelectorAll(".tab-button").forEach(e=>e.classList.remove("active")),mainTab.classList.add("active"),mainContent.classList.remove("hidden"),historyContent.classList.add("hidden"),calendarContent.classList.add("hidden"),renderClassrooms()}),historyTab.addEventListener("click",()=>{document.querySelectorAll(".tab-button").forEach(e=>e.classList.remove("active")),historyTab.classList.add("active"),mainContent.classList.add("hidden"),historyContent.classList.remove("hidden"),calendarContent.classList.add("hidden"),renderBookingHistory()}),calendarTab.addEventListener("click",()=>{document.querySelectorAll(".tab-button").forEach(e=>e.classList.remove("active")),calendarTab.classList.add("active"),mainContent.classList.add("hidden"),historyContent.classList.add("hidden"),calendarContent.classList.remove("hidden"),renderCalendar()}),prevMonthBtn.addEventListener("click",()=>{currentCalendarDate.setMonth(currentCalendarDate.getMonth()-1),selectedCalendarDate=new Date(currentCalendarDate.getFullYear(),currentCalendarDate.getMonth(),1),renderCalendar()}),nextMonthBtn.addEventListener("click",()=>{currentCalendarDate.setMonth(currentCalendarDate.getMonth()+1),selectedCalendarDate=new Date(currentCalendarDate.getFullYear(),currentCalendarDate.getMonth(),1),renderCalendar()}),closeModalBtn.addEventListener("click",()=>{bookingDetailsModal.classList.add("hidden")}),cancelConfirmBtn.addEventListener("click",handleCancelBooking),cancelNoBtn.addEventListener("click",()=>{confirmCancelModal.classList.add("hidden"),bookingToDeleteId=null}),loginForm.addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("student-id").value,n=document.getElementById("birthday").value;t&&n?(loggedInStudentId=t,studentIdDisplay.textContent=loggedInStudentId,loginContainer.classList.add("hidden"),mainAppContainer.classList.remove("hidden"),showMessage("‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!"),initializeAppUI(),setupFirestoreListener()):showMessage("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ï‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î",!0)}),document.addEventListener("DOMContentLoaded",async()=>{try{const e=initializeApp(firebaseConfig);db=getFirestore(e);const t=getAuth(e);initialAuthToken?(await signInWithCustomToken(t,initialAuthToken),console.log("Signed in with custom token.")):(await signInAnonymously(t),console.log("Signed in anonymously.")),console.log("Firebase and authentication initialized. Awaiting user login.")}catch(e){console.error("Error initializing Firebase:",e),showMessage("Failed to initialize app. Please check the console.",!0)}})</script></body></html>